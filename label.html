<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The label (la) accessor &#8212; spatialproteomics</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css?v=a123c646" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script src="_static/documentation_options.js?v=99d6104a"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js?v=dbd2e957"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The neighborhood (nh) accessor" href="neighborhood.html" />
    <link rel="prev" title="The preprocessing (pp) accessor" href="preprocessing.html" />
    <link href="_static/style.css" rel="stylesheet" type="text/css">

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">spatialproteomics</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="preprocessing.html">
   The preprocessing (
   <code class="code docutils literal notranslate">
    <span class="pre">
     pp
    </span>
   </code>
   ) accessor
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   The label (
   <code class="code docutils literal notranslate">
    <span class="pre">
     la
    </span>
   </code>
   ) accessor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="neighborhood.html">
   The neighborhood (
   <code class="code docutils literal notranslate">
    <span class="pre">
     nh
    </span>
   </code>
   ) accessor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot.html">
   The plot (
   <code class="code docutils literal notranslate">
    <span class="pre">
     pl
    </span>
   </code>
   ) accessor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tool.html">
   The tool (
   <code class="code docutils literal notranslate">
    <span class="pre">
     tl
    </span>
   </code>
   ) accessor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="image_container.html">
   The image container
  </a>
 </li>
</ul>
<p class="caption collapsible-parent" role="heading">
 <span class="caption-text">
  Tutorials:
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/Installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ExampleWorkflow.html">
   Example Workflow with spatialproteomics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ExampleWorkflowSpatialdata.html">
   Example Workflow with spatialproteomics and spatialdata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/Plotting.html">
   Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/Segmentation.html">
   Segmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ImageProcessing.html">
   Image Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/CellTypePrediction.html">
   Cell Type Prediction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/Neighborhoods.html">
   Neighborhood Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/Interoperability.html">
   Interoperability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/DownstreamAnalysis.html">
   Downstream Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/Interactivity.html">
   Interactivity with napari
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/Customizability.html">
   Customizability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/Slicing.html">
   Subselecting Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ArtifactRemoval.html">
   Interactive Removal of Artifacts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/FAQ.html">
   FAQ
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/label.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor">
   <code class="docutils literal notranslate">
    <span class="pre">
     LabelAccessor
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.add_label_property">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.add_label_property()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.add_label_type">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.add_label_type()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.add_labels">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.add_labels()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.add_labels_from_dataframe">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.add_labels_from_dataframe()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.add_properties">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.add_properties()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.deselect">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.deselect()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.predict_cell_subtypes">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.predict_cell_subtypes()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.predict_cell_types_argmax">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.predict_cell_types_argmax()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.remove_label_type">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.remove_label_type()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.set_label_colors">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.set_label_colors()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.set_label_level">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.set_label_level()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.set_label_name">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.set_label_name()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatialproteomics.la.label.LabelAccessor.threshold_labels">
     <code class="docutils literal notranslate">
      <span class="pre">
       LabelAccessor.threshold_labels()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spatialproteomics.la.label.predict_cell_subtypes">
   <code class="docutils literal notranslate">
    <span class="pre">
     predict_cell_subtypes()
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spatialproteomics.la.label.predict_cell_types_argmax">
   <code class="docutils literal notranslate">
    <span class="pre">
     predict_cell_types_argmax()
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spatialproteomics.la.label.threshold_labels">
   <code class="docutils literal notranslate">
    <span class="pre">
     threshold_labels()
    </span>
   </code>
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="the-label-la-accessor">
<h1>The label (<code class="code docutils literal notranslate"><span class="pre">la</span></code>) accessor<a class="headerlink" href="#the-label-la-accessor" title="Link to this heading">¶</a></h1>
<p>The label accessor provides several functions associated with cell type annotations and gating.</p>
<dl class="py class" id="module-spatialproteomics.la.label">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">spatialproteomics.la.label.</span></span><span class="sig-name descname"><span class="pre">LabelAccessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarray_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor" title="Link to this definition">¶</a></dt>
<dd><p>Adds functions for cell phenotyping.</p>
<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.add_label_property">
<span class="sig-name descname"><span class="pre">add_label_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.add_label_property" title="Link to this definition">¶</a></dt>
<dd><p>Add a label property for each unique cell type label.</p>
<p>This method adds a property, specified by ‘prop’, for each unique cell type label in the data object.
The property values are taken from the ‘array’ argument and assigned to each corresponding cell type label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>numpy.ndarray</em><em> or </em><em>list</em>) – An array or list containing property values to be assigned to each unique cell type label.</p></li>
<li><p><strong>prop</strong> (<em>str</em>) – The name of the property to be added to the cell type labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated data object with the added label property.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.add_label_type">
<span class="sig-name descname"><span class="pre">add_label_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.add_label_type" title="Link to this definition">¶</a></dt>
<dd><p>Add a new label type to the data object.</p>
<p>This method adds a new label type with the specified ‘name’ and ‘color’ to the data object.
The label type is used to identify and categorize cells in the segmentation mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the new label type to be added.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – The color code to represent the new label type in the visualization. Default is “white” (“w”).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated data object with the newly added label type.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the segmentation mask or observation table is not found in the data object.
    If the provided ‘name’ already exists as a label type.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function checks for the existence of the segmentation mask and observation table in the data object.</p></li>
<li><p>It ensures that the ‘name’ of the new label type does not already exist in the label types.</p></li>
<li><p>The function then adds the new label type with the given ‘name’ and ‘color’ to the data object.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.add_labels">
<span class="sig-name descname"><span class="pre">add_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.add_labels" title="Link to this definition">¶</a></dt>
<dd><p>Add labels from a mapping (cell -&gt; label) to the spatialproteomics object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>labels</strong> (<em>Union</em><em>[</em><em>dict</em><em>, </em><em>None</em><em>]</em>) – A dictionary containing cell labels as keys and corresponding labels as values.
If None, a default labeling will be added. Default is None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>xr.Dataset</em> – The spatialproteomics object with added labels.</p></li>
<li><p><em>Notes</em></p></li>
<li><p><em>——</em></p></li>
<li><p><em>This method converts the input dictionary into a pandas DataFrame and then adds the labels to the object</em></p></li>
<li><p>using the <cite>la.add_labels_from_dataframe</cite> method.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.add_labels_from_dataframe">
<span class="sig-name descname"><span class="pre">add_labels_from_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cell'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_neighborhoods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.add_labels_from_dataframe" title="Link to this definition">¶</a></dt>
<dd><p>Adds labels to the image container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – A dataframe with the cell and label information. If None, a default labeling will be applied.</p></li>
<li><p><strong>cell_col</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column in the dataframe representing cell coordinates. Default is “cell”.</p></li>
<li><p><strong>label_col</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column in the dataframe representing cell labels. Default is “label”.</p></li>
<li><p><strong>colors</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – A list of colors corresponding to the cell labels. If None, random colors will be assigned. Default is None.</p></li>
<li><p><strong>names</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – A list of names corresponding to the cell labels. If None, default names will be assigned. Default is None.</p></li>
<li><p><strong>ignore_neighborhoods</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the function will ignore the neighborhoods in the object. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated image container with added labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.add_properties">
<span class="sig-name descname"><span class="pre">add_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'_labels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_xarray</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.add_properties" title="Link to this definition">¶</a></dt>
<dd><p>Adds properties to the image container. In order to add properties to an already existing property layer, use the la.add_label_property() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><em>list</em><em>]</em>) – An array or list of properties to be added to the image container.</p></li>
<li><p><strong>prop</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the property. Default is Features.LABELS.</p></li>
<li><p><strong>return_xarray</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the function returns an xarray.DataArray with the properties instead of adding them to the image container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated image container with added properties or the properties as a separate xarray.DataArray.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset or xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.deselect">
<span class="sig-name descname"><span class="pre">deselect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.deselect" title="Link to this definition">¶</a></dt>
<dd><p>Deselect specific label indices from the data object.</p>
<p>This method deselects specific label indices from the data object, effectively removing them from the selection.
The deselection can be performed using slices, lists, tuples, or individual integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>slice</em><em>, </em><em>list</em><em>, </em><em>tuple</em><em>, or </em><em>int</em>) – The label indices to be deselected. Can be a slice, list, tuple, or an individual integer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated data object with the deselected label indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses ‘indices’ to specify which labels to deselect.</p></li>
<li><p>‘indices’ can be provided as slices, lists, tuples, or an integer.</p></li>
<li><p>The function then updates the data object to remove the deselected label indices.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.predict_cell_subtypes">
<span class="sig-name descname"><span class="pre">predict_cell_subtypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subtype_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_existing_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.predict_cell_subtypes" title="Link to this definition">¶</a></dt>
<dd><p>Predict cell subtypes based on the binarized marker intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subtype_dict</strong> (<em>dict</em>) – A dictionary mapping cell subtypes to the binarized markers used for prediction.
Instead of a dictionary, a path to a yaml file containing the subtype dictionary can be provided.</p></li>
<li><p><strong>overwrite_existing_labels</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, existing labels will be overwritten by the new, more granular cell type predictions. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated image container with the predicted cell subtypes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.predict_cell_types_argmax">
<span class="sig-name descname"><span class="pre">predict_cell_types_argmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marker_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'_intensity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_existing_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cell'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'label'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.predict_cell_types_argmax" title="Link to this definition">¶</a></dt>
<dd><p>Predicts cell types based on the argmax classification of marker intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marker_dict</strong> (<em>dict</em>) – A dictionary mapping markers to cell types. Each marker should be associated to one specific cell type.</p></li>
<li><p><strong>key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key of the quantification layer to use for classification. Defaults to “_intensity”.</p></li>
<li><p><strong>overwrite_existing_labels</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to overwrite existing labels. Defaults to False.</p></li>
<li><p><strong>cell_col</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column to store cell IDs in the output dataframe. Defaults to “cell”.</p></li>
<li><p><strong>label_col</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the column to store predicted cell types in the output dataframe. Defaults to “label”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new spatialproteomics object with the predicted cell types added as labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – If the quantification layer with the specified key is not found.</p></li>
<li><p><strong>AssertionError</strong> – If any of the markers specified in the marker dictionary are not present in the quantification layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.remove_label_type">
<span class="sig-name descname"><span class="pre">remove_label_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.remove_label_type" title="Link to this definition">¶</a></dt>
<dd><p>Remove specific cell type label(s) from the data object.</p>
<p>This method removes specific cell type label(s) identified by ‘cell_type’ from the data object.
The cell type label(s) are effectively removed, and their associated cells are assigned to the ‘Unlabeled’ category.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cell_type</strong> (<em>int</em><em> or </em><em>list</em><em> of </em><em>int</em>) – The ID(s) of the cell type label(s) to be removed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated data object with the specified cell type label(s) removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the data object does not contain any cell type labels.
    If the specified ‘cell_type’ is not found among the existing cell type labels.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function first checks for the existence of cell type labels in the data object.</p></li>
<li><p>It then removes the specified ‘cell_type’ from the cell type labels, setting their cells to the ‘Unlabeled’ category.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.set_label_colors">
<span class="sig-name descname"><span class="pre">set_label_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.set_label_colors" title="Link to this definition">¶</a></dt>
<dd><p>Set the color of a specific cell type label.</p>
<p>This method sets the ‘color’ of a specific cell type label identified by the ‘label’.
The ‘label’ can be either a label ID or the name of the cell type label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>int</em><em> or </em><em>str</em>) – The ID or name of the cell type label whose color will be updated.</p></li>
<li><p><strong>color</strong> (<em>any</em>) – The new color to be assigned to the specified cell type label.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function converts the ‘label’ from its name to the corresponding ID for internal processing.</p></li>
<li><p>It updates the color of the cell type label in the data object to the new ‘color’.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.set_label_level">
<span class="sig-name descname"><span class="pre">set_label_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_neighborhoods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span></span></span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.set_label_level" title="Link to this definition">¶</a></dt>
<dd><p>Set the label level to a specific level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>str</em>) – The name of the label level to set.</p></li>
<li><p><strong>ignore_neighborhoods</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the function will ignore the neighborhoods in the object. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated image container with the label level set to the specified level.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.set_label_name">
<span class="sig-name descname"><span class="pre">set_label_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.set_label_name" title="Link to this definition">¶</a></dt>
<dd><p>Set the name of a specific cell type label.</p>
<p>This method sets the ‘name’ of a specific cell type label identified by the ‘label’.
The ‘label’ can be either a label ID or the name of the cell type label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>int</em><em> or </em><em>str</em>) – The ID or name of the cell type label whose name will be updated.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The new name to be assigned to the specified cell type label.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function converts the ‘label’ from its name to the corresponding ID for internal processing.</p></li>
<li><p>It updates the name of the cell type label in the data object to the new ‘name’.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spatialproteomics.la.label.LabelAccessor.threshold_labels">
<span class="sig-name descname"><span class="pre">threshold_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'_intensity'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.LabelAccessor.threshold_labels" title="Link to this definition">¶</a></dt>
<dd><p>Binarise based on a threshold.
If a label is specified, the binarization is only applied to this cell type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold_dict</strong> (<em>dict</em>) – A dictionary mapping channels to threshold values.</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>optional</em>) – The specified cell type for which the binarization is applied, by default None.</p></li>
<li><p><strong>layer_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key for the new binary feature layer, by default “_percentage_positive_intensity”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new dataset object with the binary features added.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If a label is specified, the binarization is only applied to the cells of that specific cell type.</p></li>
<li><p>The binary feature is computed by comparing the intensity values of each channel to the threshold value.</p></li>
<li><p>The binary feature is added as a new layer to the dataset object.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialproteomics.la.label.predict_cell_subtypes">
<span class="sig-prename descclassname"><span class="pre">spatialproteomics.la.label.</span></span><span class="sig-name descname"><span class="pre">predict_cell_subtypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtype_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'table'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'binarization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'celltype'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.predict_cell_subtypes" title="Link to this definition">¶</a></dt>
<dd><p>This function predicts cell subtypes based on the expression matrix using a subtype dictionary.
It extracts the expression matrix from the spatialdata object, applies the subtype prediction method,
and adds the predicted cell subtypes to the spatialdata object.
The predicted cell subtypes are stored in the obs attribute of the AnnData object in the tables attribute of the spatialdata object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdata</strong> (<em>spatialdata.SpatialData</em>) – The spatialdata object containing the expression matrix.</p></li>
<li><p><strong>subtype_dict</strong> (<em>Union</em><em>[</em><em>dict</em><em>, </em><em>str</em><em>]</em>) – A dictionary mapping cell subtypes to the binarized markers used for prediction. Instead of a dictionary, a path to a yaml file containing the subtype dictionary can be provided.</p></li>
<li><p><strong>table_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key under which the expression matrix is stored in the tables attribute of the spatialdata object. Defaults to “table”.</p></li>
<li><p><strong>layer_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key under which the binarized expression matrix is stored in the obsm attribute of the spatialdata object. Defaults to “binarization”.</p></li>
<li><p><strong>label_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key under which the cell type labels are stored in the obs attribute of the spatialdata object. Defaults to “celltype”.</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to create a copy of the spatialdata object. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialproteomics.la.label.predict_cell_types_argmax">
<span class="sig-prename descclassname"><span class="pre">spatialproteomics.la.label.</span></span><span class="sig-name descname"><span class="pre">predict_cell_types_argmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'table'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'celltype'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.predict_cell_types_argmax" title="Link to this definition">¶</a></dt>
<dd><p>This function predicts cell types based on the expression matrix using the argmax method.
It extracts the expression matrix from the spatialdata object, applies the argmax method,
and adds the predicted cell types to the spatialdata object.
The predicted cell types are stored in the obs attribute of the AnnData object in the tables attribute of the spatialdata object.
The argmax method assigns the cell type with the highest expression value to each cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdata</strong> (<em>spatialdata.SpatialData</em>) – The spatialdata object containing the expression matrix.</p></li>
<li><p><strong>marker_dict</strong> (<em>dict</em>) – A dictionary containing the marker genes for each cell type.</p></li>
<li><p><strong>table_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key under which the expression matrix is stored in the tables attribute of the spatialdata object. Defaults to “table”.</p></li>
<li><p><strong>label_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key under which the cell type labels are stored in the obs attribute of the spatialdata object. Defaults to “celltype”.</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to create a copy of the spatialdata object. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialproteomics.la.label.threshold_labels">
<span class="sig-prename descclassname"><span class="pre">spatialproteomics.la.label.</span></span><span class="sig-name descname"><span class="pre">threshold_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_added</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'binarization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'table'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'perc_pos'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialproteomics.la.label.threshold_labels" title="Link to this definition">¶</a></dt>
<dd><p>Binarise based on a threshold. If a label is specified, the binarization is only applied to this cell type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdata</strong> (<em>spatialdata.SpatialData</em>) – The spatialdata object containing the expression matrix.</p></li>
<li><p><strong>threshold_dict</strong> (<em>dict</em>) – A dictionary containing the threshold values for each channel.</p></li>
<li><p><strong>key_added</strong> (<em>str</em><em>, </em><em>optional</em>) – The key under which the processed expression matrix will be stored in the obsm attribute of the spatialdata object. Defaults to “binarization”.</p></li>
<li><p><strong>table_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key under which the expression matrix is stored in the tables attribute of the spatialdata object. Defaults to “table”.</p></li>
<li><p><strong>layer_key</strong> (<em>str</em><em>, </em><em>optional</em>) – The key under which the expression matrix is stored in the layers attribute of the spatialdata object. Defaults to “perc_pos”.</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to create a copy of the spatialdata object. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="preprocessing.html" title="previous page">The preprocessing (<code class="code docutils literal notranslate"><span class="pre">pp</span></code>) accessor</a>
    <a class='right-next' id="next-link" href="neighborhood.html" title="next page">The neighborhood (<code class="code docutils literal notranslate"><span class="pre">nh</span></code>) accessor</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Matthias Meyer-Bender, Harald Vohringer<br/>
        
            &copy; Copyright 2024, Matthias Meyer-Bender, Harald Vohringer.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>